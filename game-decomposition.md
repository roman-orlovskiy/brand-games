# Декомпозиция проекта "Игра - Попади из лука в нужный приз"

## Анализ концепта

На основе баннера создается игра где:
- **Дерево с призами**: Плоды на дереве представляют различные призы (подарки, бутылки, плохие призы)
- **Стрелок с луком**: Игрок стреляет по целям на дереве
- **Система попаданий**: Определение попадания через пересечение SVG траектории с плодом
- **Накопление скидок**: Призы накапливаются как скидки

---

## 1. ФРОНТЕНД (Vue 3 + Pinia + Верстка)

### 1.1 Основная структура игры (16 часов)

#### 1.1.1 Игровое поле и дерево (6 часов)
- **Компонент GameField.vue** (3 часа)
  - Создание SVG-дерева с динамическими плодами
  - Позиционирование призов на ветках
  - Адаптивная верстка под разные экраны
  - Анимация покачивания дерева

- **Компонент Target.vue** (3 часа)
  - SVG плоды с разными типами призов
  - Зоны попадания (центральная зона = максимальная скидка)
  - Анимация подсветки при наведении
  - Звуковые эффекты при попадании

#### 1.1.2 Система стрельбы (5 часов)
- **Компонент Archer.vue** (3 часа)
  - SVG лук и стрелок
  - Анимация натяжения тетивы
  - Расчет траектории полета стрелы
  - Система прицеливания

- **Компонент Arrow.vue** (2 часа)
  - SVG стрела с траекторией полета
  - Физика полета (гравитация, сопротивление)
  - Определение пересечения с плодами
  - Анимация попадания/промаха

#### 1.1.3 Игровая логика (5 часов)
- **Store GameStore.js (Pinia)** (3 часа)
  - Состояние игры (очки, скидки, выстрелы)
  - Логика определения попаданий
  - Расчет скидок по зонам
  - Система прогресса

- **Composable useGameLogic.js** (2 часа)
  - Обработка кликов и событий
  - Управление игровым циклом
  - Валидация результатов

### 1.2 UI/UX компоненты (12 часов)

#### 1.2.1 Игровой интерфейс (6 часов)
- **Компонент GameUI.vue** (3 часа)
  - Счетчик очков и скидок
  - Прогресс-бар накопленных призов
  - Кнопки управления игрой
  - Таймер (если нужен)

- **Компонент ScoreBoard.vue** (3 часа)
  - Таблица результатов
  - История выстрелов
  - Анимация обновления счета

#### 1.2.2 Модальные окна (6 часов)
- **Компонент ResultModal.vue** (4 часа)
  - Форма для получения промокода
  - Валидация полей (имя, телефон, email)
  - Чекбокс согласия на обработку данных
  - Отображение результата и промокода

- **Компонент SettingsModal.vue** (2 часа)
  - Настройки звука и графики
  - Инструкции по игре
  - Информация о призах

### 1.3 Система брендинга (8 часов)

#### 1.3.1 Брендинг компоненты (5 часов)
- **Компонент BrandingSystem.vue** (3 часа)
  - Динамическая загрузка логотипов
  - Применение цветовых схем
  - Кастомизация фона игры

- **Composable useBranding.js** (2 часа)
  - Получение настроек бренда из API
  - Применение стилей к компонентам
  - Кеширование брендинга

#### 1.3.2 Адаптация дизайна (3 часа)
- **Динамические стили** (2 часа)
  - CSS переменные для цветов бренда
  - Адаптация мишени под стиль
  - Кастомизация элементов управления

- **Responsive дизайн** (1 час)
  - Адаптация под мобильные устройства
  - Оптимизация для touch-устройств

### 1.4 Интеграция и оптимизация (6 часов)

#### 1.4.1 API интеграция (4 часа)
- **Service GameAPI.js** (2 часа)
  - Отправка результатов игры
  - Получение настроек бренда
  - Обработка ошибок

- **Composable useAPI.js** (2 часа)
  - HTTP клиент с axios
  - Обработка состояний загрузки
  - Retry логика

#### 1.4.2 Оптимизация производительности (2 часа)
- **Lazy loading компонентов** (1 час)
- **Оптимизация анимаций** (1 час)
  - CSS transitions вместо JS анимаций
  - requestAnimationFrame для плавности

---

## 2. БЭКЕНД (Node.js/Express + MySQL)

### 2.1 Основная архитектура сервера (8 часов)

#### 2.1.1 Настройка сервера (3 часа)
- **Настройка Express.js** (1 час)
  - Базовый сервер с middleware
  - CORS настройки
  - Логирование и обработка ошибок

- **Подключение к базе данных** (2 часа)
  - MySQL подключение и пул соединений
  - Миграции базы данных
  - Система резервного копирования

#### 2.1.2 Аутентификация и авторизация (5 часов)
- **JWT система** (3 часа)
  - Генерация и валидация токенов
  - Middleware для проверки прав доступа
  - Refresh token механизм

- **OAuth интеграция** (2 часа)
  - Google OAuth (опционально)
  - Яндекс OAuth (опционально)
  - Fallback на email/password

### 2.2 API для игры (12 часов)

#### 2.2.1 Игровые эндпоинты (6 часов)
- **POST /api/game/result** (2 часа)
  - Сохранение результата игры
  - Валидация данных пользователя
  - Генерация промокодов

- **GET /api/game/brand-settings/:brandId** (2 часа)
  - Получение настроек бренда
  - Кеширование настроек
  - Fallback на дефолтные настройки

- **POST /api/game/validate-hit** (2 часа)
  - Валидация попадания на сервере
  - Античит проверки
  - Логирование подозрительной активности

#### 2.2.2 Пользовательские эндпоинты (6 часов)
- **POST /api/users/register** (2 часа)
  - Регистрация пользователя
  - Валидация email/пароля
  - Отправка подтверждения

- **POST /api/users/login** (2 часа)
  - Авторизация пользователя
  - Проверка учетных данных
  - Возврат JWT токена

- **GET /api/users/profile** (2 часа)
  - Получение профиля пользователя
  - История игр пользователя
  - Статистика по играм

### 2.3 Система промокодов (6 часов)

#### 2.3.1 Генерация и управление (4 часа)
- **PromoCodeService.js** (2 часа)
  - Генерация уникальных промокодов
  - Проверка валидности кодов
  - Система скидок по зонам

- **Промокод эндпоинты** (2 часа)
  - POST /api/promo/generate
  - GET /api/promo/validate/:code
  - PUT /api/promo/deactivate/:code

#### 2.3.2 Интеграция с внешними системами (2 часа)
- **Экспорт данных** (1 час)
  - Экспорт в XLS/CSV форматы
  - Фильтрация и сортировка данных
  - Архивирование результатов

- **Email уведомления** (1 час)
  - Отправка промокодов на email
  - Уведомления о новых играх
  - Шаблоны писем

### 2.4 Административные API (10 часов)

#### 2.4.1 Управление брендами (4 часа)
- **CRUD для брендов** (2 часа)
  - POST /api/admin/brands
  - GET /api/admin/brands
  - PUT /api/admin/brands/:id
  - DELETE /api/admin/brands/:id

- **Настройки брендов** (2 часа)
  - POST /api/admin/brand-settings
  - GET /api/admin/brand-settings/:brandId
  - PUT /api/admin/brand-settings/:id

#### 2.4.2 Управление игрой (3 часа)
- **Настройки игры** (2 часа)
  - POST /api/admin/game-settings
  - GET /api/admin/game-settings
  - PUT /api/admin/game-settings/:id

- **Статистика и аналитика** (1 час)
  - GET /api/admin/analytics
  - Экспорт отчетов
  - Дашборд метрик

#### 2.4.3 Управление пользователями (3 часа)
- **CRUD пользователей** (2 часа)
  - GET /api/admin/users
  - PUT /api/admin/users/:id
  - DELETE /api/admin/users/:id

- **Результаты игр** (1 час)
  - GET /api/admin/game-results
  - Фильтрация и поиск
  - Массовые операции

### 2.5 База данных (8 часов)

#### 2.5.1 Схема базы данных (4 часа)
- **Таблицы пользователей** (1 час)
  ```sql
  users, user_sessions, user_profiles
  ```

- **Таблицы игр** (1 час)
  ```sql
  games, game_results, game_settings
  ```

- **Таблицы брендов** (1 час)
  ```sql
  brands, brand_settings, brand_customizations
  ```

- **Таблицы промокодов** (1 час)
  ```sql
  promo_codes, promo_usage, discount_zones
  ```

#### 2.5.2 Индексы и оптимизация (2 часа)
- **Индексы для производительности** (1 час)
- **Партиционирование таблиц** (1 час)

#### 2.5.3 Миграции и сиды (2 часа)
- **Система миграций** (1 час)
- **Начальные данные** (1 час)

---

## 3. АДМИНИСТРАТИВНАЯ ПАНЕЛЬ (Vue 3 + Pinia)

### 3.1 Основная структура админки (10 часов)

#### 3.1.1 Аутентификация админов (3 часа)
- **AdminAuth.vue** (2 часа)
  - Форма входа в админку
  - JWT токены для админов
  - Защищенные маршруты

- **AdminGuard.js** (1 час)
  - Middleware для проверки прав
  - Редирект на логин
  - Роли и разрешения

#### 3.1.2 Основной интерфейс (7 часов)
- **AdminLayout.vue** (3 часа)
  - Боковое меню навигации
  - Хедер с профилем админа
  - Breadcrumbs навигация

- **AdminDashboard.vue** (4 часа)
  - Общая статистика
  - Графики активности
  - Быстрые действия
  - Уведомления

### 3.2 Управление брендами (12 часов)

#### 3.2.1 CRUD брендов (6 часов)
- **BrandList.vue** (3 часа)
  - Таблица всех брендов
  - Поиск и фильтрация
  - Массовые операции
  - Пагинация

- **BrandForm.vue** (3 часа)
  - Форма создания/редактирования
  - Валидация данных
  - Загрузка логотипов
  - Предпросмотр брендинга

#### 3.2.2 Настройки брендинга (6 часов)
- **BrandSettings.vue** (4 часа)
  - Цветовая палитра
  - Настройка мишени
  - Фоновые изображения
  - Логотипы и иконки

- **BrandPreview.vue** (2 часа)
  - Предпросмотр игры с брендингом
  - Тестирование настроек
  - Сравнение версий

### 3.3 Управление игрой (10 часов)

#### 3.3.1 Настройки игры (5 часов)
- **GameSettings.vue** (3 часа)
  - Размеры скидок по зонам
  - Настройка призов
  - Параметры физики
  - Ограничения игры

- **PrizeManagement.vue** (2 часа)
  - Управление типами призов
  - Настройка вероятностей
  - Визуальные эффекты

#### 3.3.2 Статистика игр (5 часов)
- **GameAnalytics.vue** (3 часа)
  - Графики активности
  - Конверсия игроков
  - Популярные зоны попаданий
  - Временная аналитика

- **GameReports.vue** (2 часа)
  - Экспорт отчетов
  - Фильтрация по периодам
  - Сравнительная аналитика

### 3.4 Управление пользователями (8 часов)

#### 3.4.1 Пользователи и результаты (5 часов)
- **UserManagement.vue** (3 часа)
  - Список пользователей
  - Детали профиля
  - История игр
  - Блокировка/разблокировка

- **GameResults.vue** (2 часа)
  - Детали результатов
  - Фильтрация по брендам
  - Экспорт данных
  - Поиск по промокодам

#### 3.4.2 Личные кабинеты (3 часа)
- **UserCabinet.vue** (2 часа)
  - Настройки игры для пользователя
  - История выигрышей
  - Управление промокодами

- **CabinetSettings.vue** (1 час)
  - Персональные настройки
  - Уведомления
  - Безопасность

### 3.5 Система промокодов (6 часов)

#### 3.5.1 Управление промокодами (4 часа)
- **PromoCodeManagement.vue** (2 часа)
  - Список промокодов
  - Статистика использования
  - Активация/деактивация

- **PromoCodeGenerator.vue** (2 часа)
  - Настройка генерации
  - Массовое создание
  - Шаблоны промокодов

#### 3.5.2 Отчетность (2 часа)
- **PromoAnalytics.vue** (2 часа)
  - Аналитика использования
  - ROI промокодов
  - Экспорт отчетов

---

## 4. СИСТЕМА БРЕНДИНГА

### 4.1 Динамическое брендинг (8 часов)

#### 4.1.1 Цветовые схемы (3 часа)
- **BrandColorSystem.js** (2 часа)
  - Палитры цветов для брендов
  - CSS переменные
  - Темная/светлая темы

- **ColorPicker.vue** (1 час)
  - Выбор цветов в админке
  - Предпросмотр изменений
  - Валидация контрастности

#### 4.1.2 Логотипы и изображения (3 часа)
- **BrandAssetManager.js** (2 часа)
  - Загрузка и оптимизация изображений
  - Автоматическое изменение размеров
  - CDN интеграция

- **AssetUpload.vue** (1 час)
  - Drag & drop загрузка
  - Предпросмотр изображений
  - Валидация форматов

#### 4.1.3 Кастомизация мишени (2 часа)
- **TargetCustomizer.js** (1 час)
  - Настройка внешнего вида мишени
  - Адаптация под стиль бренда

- **TargetPreview.vue** (1 час)
  - Интерактивный предпросмотр
  - Тестирование настроек

### 4.2 Мультибрендинг (6 часов)

#### 4.2.1 Система брендов (3 часа)
- **BrandSwitcher.js** (2 часа)
  - Переключение между брендами
  - Кеширование настроек
  - Fallback на дефолт

- **BrandContext.vue** (1 час)
  - Контекст бренда в приложении
  - Автоматическое применение стилей

#### 4.2.2 Iframe интеграция (3 часа)
- **EmbedGame.js** (2 часа)
  - Встраивание игры на сайты
  - Безопасность iframe
  - Responsive адаптация

- **EmbedConfig.vue** (1 час)
  - Настройка параметров встраивания
  - Генерация кода встраивания
  - Тестирование на разных сайтах

### 4.3 Адаптивный брендинг (4 часа)

#### 4.3.1 Responsive дизайн (2 часа)
- **ResponsiveBranding.js** (1 час)
  - Адаптация под разные экраны
  - Оптимизация для мобильных

- **MobileOptimization.vue** (1 час)
  - Touch-friendly интерфейс
  - Упрощенная версия для мобильных

#### 4.3.2 Производительность (2 часа)
- **BrandOptimization.js** (1 час)
  - Ленивая загрузка ресурсов
  - Кеширование стилей

- **PerformanceMonitoring.js** (1 час)
  - Мониторинг загрузки
  - Оптимизация изображений

---

## 5. ДОПОЛНИТЕЛЬНЫЕ КОМПОНЕНТЫ

### 5.1 Система безопасности (4 часа)
- **Rate limiting** (1 час)
- **Валидация входных данных** (1 час)
- **Защита от XSS/CSRF** (1 час)
- **Логирование безопасности** (1 час)

### 5.2 Мониторинг и аналитика (3 часа)
- **Google Analytics интеграция** (1 час)
- **Система метрик** (1 час)
- **Ошибки и логирование** (1 час)

### 5.3 Деплой и DevOps (5 часов)
- **Настройка сервера** (2 часа)
- **CI/CD пайплайн** (2 часа)
- **Резервное копирование** (1 час)

---

## 🕐 ИТОГОВАЯ ОЦЕНКА ВРЕМЕНИ

### Для миддл разработчика (фронт + немного бэк)

| Компонент | Часы | Описание |
|-----------|------|----------|
| **ФРОНТЕНД** | **42 часа** | Vue 3 + Pinia, без Canvas |
| ├─ Основная игра | 16ч | SVG дерево, стрельба, логика |
| ├─ UI/UX | 12ч | Интерфейс, модалки |
| ├─ Брендинг | 8ч | Динамические стили |
| └─ Интеграция | 6ч | API, оптимизация |
| **БЭКЕНД** | **44 часа** | Node.js + MySQL |
| ├─ Сервер | 8ч | Express, БД, аутентификация |
| ├─ API игры | 12ч | Игровые эндпоинты |
| ├─ Промокоды | 6ч | Генерация, валидация |
| ├─ Админ API | 10ч | Управление, CRUD |
| └─ База данных | 8ч | Схема, миграции |
| **АДМИНКА** | **46 часов** | Vue 3 админ-панель |
| ├─ Основная структура | 10ч | Аутентификация, интерфейс |
| ├─ Управление брендами | 12ч | CRUD, настройки |
| ├─ Управление игрой | 10ч | Настройки, аналитика |
| ├─ Пользователи | 8ч | Управление, кабинеты |
| └─ Промокоды | 6ч | Управление, отчеты |
| **БРЕНДИНГ** | **18 часов** | Система мультибрендинга |
| ├─ Динамическое брендинг | 8ч | Цвета, логотипы |
| ├─ Мультибрендинг | 6ч | Переключение, iframe |
| └─ Адаптивность | 4ч | Responsive, производительность |
| **ДОПОЛНИТЕЛЬНО** | **12 часов** | Безопасность, мониторинг |
| ├─ Безопасность | 4ч | Rate limiting, валидация |
| ├─ Аналитика | 3ч | Метрики, логирование |
| └─ DevOps | 5ч | Деплой, резервы |

### 📊 **ОБЩЕЕ ВРЕМЯ: 162 ЧАСА**

### 📅 **ВРЕМЕННЫЕ РАМКИ**
- **Рабочие дни**: ~20 дней (8 часов в день)
- **Календарные дни**: ~4 недели (с выходными)
- **С учетом тестирования**: +20% = **194 часа** (~24 рабочих дня)

### 💡 **РЕКОМЕНДАЦИИ ПО РЕАЛИЗАЦИИ**

1. **Этап 1** (Неделя 1): Основная игра + базовый бэкенд
2. **Этап 2** (Неделя 2): Админка + система брендинга  
3. **Этап 3** (Неделя 3): Интеграция + тестирование
4. **Этап 4** (Неделя 4): Полировка + деплой

### 🛠️ **ТЕХНИЧЕСКИЕ ДЕТАЛИ**

- **Фронт**: Vue 3 Composition API + Pinia + Vite
- **Бэк**: Node.js + Express + MySQL + JWT
- **Стили**: SCSS + CSS переменные для брендинга
- **Анимации**: CSS transitions + SVG анимации
- **Деплой**: Docker + Nginx + PM2

---

## 🎯 ЗАКЛЮЧЕНИЕ

Создана полная декомпозиция проекта "Игра - Попади из лука в нужный приз" на основе предоставленного концепта баннера. 

**Ключевые особенности реализации:**
- ✅ **Без Canvas** - вся игра на SVG и CSS верстке
- ✅ **Vue 3 + Pinia** - современный стек фронтенда
- ✅ **Система брендинга** - полная кастомизация под бренды
- ✅ **Админка** - управление всеми аспектами игры
- ✅ **Личные кабинеты** - для клиентов и пользователей
- ✅ **Промокоды** - система скидок и накоплений
- ✅ **Iframe интеграция** - встраивание на сайты брендов

**Общее время разработки: 162-194 часа** для миддл разработчика с опытом фронтенда и базовыми знаниями бэкенда.

Проект готов к реализации "под ключ" с полной настройкой сервера, базы данных и деплоем на инфраструктуру заказчика.
